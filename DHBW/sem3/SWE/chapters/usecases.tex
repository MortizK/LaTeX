\section{Anwenderfälle}

\subsection{Aktoren}

Die primären Akteure der Software sind Dozierende oder anderes lehrendes Personal,
welches Aufgabenpools verwalten und daraus Klausuren generieren möchte.
Es werden lediglich grundlegende Computerkenntnisse vorausgesetzt.

\begin{center}
\resizebox{\textwidth}{!}{%
\begin{tikzpicture}[node distance=1cm and 1cm]

% --------------------
% Actor: Dozent in der Mitte
\node[actor] (Dozent) at (0,0) {Dozierender};

% --------------------
% Obere Reihe: Dateiverwaltung, System-Utilities, Klausur-Generierung
\node[usecase, above=5cm of Dozent, xshift=-7cm] (UC01) {UC-01:\\XML-Datei neu anlegen};
\node[usecase, below=0.5cm of UC01] (UC02) {UC-02:\\XML-Datei laden};
\node[usecase, below=0.5cm of UC02] (UC03) {UC-03:\\XML-Datei speichern / Speichern unter};
\node[package, fit=(UC01)(UC02)(UC03), label=above:Dateiverwaltung] (PkgDV) {};

\node[usecase, above=5cm of Dozent, xshift=0cm] (UC18) {UC-18:\\Sprache ändern};
\node[package, fit=(UC18), label=above:System-Utilities] (PkgSys) {};

\node[usecase, above=5cm of Dozent, xshift=6cm] (UC13) {UC-13:\\Klausurkonfiguration öffnen};
\node[usecase, below=0.5cm of UC13] (UC14) {UC-14:\\Klausur generieren (PDF)};
\node[usecase, below=0.5cm of UC14] (UC15) {UC-15:\\Musterlösung generieren (PDF)};
\node[usecase, below=0.5cm of UC15] (UC16) {UC-16:\\Probeklausur generieren};
\node[usecase, below=0.5cm of UC16] (UC17) {UC-17:\\PDF-Vorschau anzeigen};
\node[package, fit=(UC13)(UC17), label=above:Klausur-Generierung] (PkgExam) {};

% --------------------
% Untere Reihe: Kapitel-Management, Teilaufgaben-Management, Varianten-Management
\node[usecase, below=5cm of Dozent, xshift=-6cm] (UC04) {UC-04:\\Kapitel anlegen};
\node[usecase, below=0.5cm of UC04] (UC05) {UC-05:\\Kapitel bearbeiten};
\node[usecase, below=0.5cm of UC05] (UC06) {UC-06:\\Kapitel löschen};
\node[package, fit=(UC04)(UC05)(UC06), label=above:Kapitel-Management] (PkgKap) {};

\node[usecase, below=5cm of Dozent] (UC07) {UC-07:\\Teilaufgabe anlegen};
\node[usecase, below=0.5cm of UC07] (UC08) {UC-08:\\Teilaufgabe bearbeiten};
\node[usecase, below=0.5cm of UC08] (UC09) {UC-09:\\Teilaufgabe löschen};
\node[package, fit=(UC07)(UC08)(UC09), label=above:Teilaufgaben-Management] (PkgSub) {};

\node[usecase, below=5cm of Dozent, xshift=6cm] (UC10) {UC-10:\\Variante anlegen};
\node[usecase, below=0.5cm of UC10] (UC11) {UC-11:\\Variante bearbeiten};
\node[usecase, below=0.5cm of UC11] (UC12) {UC-12:\\Variante löschen};
\node[package, fit=(UC10)(UC11)(UC12), label=above:Varianten-Management] (PkgVar) {};

% --------------------
% Pfeile: Dozent zu Use Cases
\foreach \uc in {UC01,UC02,UC03,UC18,UC13,UC14,UC15,UC16,UC17,UC04,UC05,UC06,UC07,UC08,UC09,UC10,UC11,UC12}
    \draw[->] (Dozent.north) -- (\uc.south);

\end{tikzpicture}

}
\end{center}

\pagebreak
\begin{multicols}{2}
\raggedcolumns

\subsection{Übersicht der Anwenderfälle}

\begin{tabular}{ll}
    UC-01 & \hyperref[uc:01]{XML-Datei neu anlegen} \\
    UC-02 & \hyperref[uc:02]{XML-Datei laden} \\
    UC-03 & \hyperref[uc:03]{XML-Datei speichern / Speichern unter} \\
    UC-04 & \hyperref[uc:04]{Kapitel anlegen} \\
    UC-05 & \hyperref[uc:05]{Kapitel bearbeiten} \\
    UC-06 & \hyperref[uc:06]{Kapitel löschen} \\
    UC-07 & \hyperref[uc:07]{Teilaufgabe anlegen} \\
    UC-08 & \hyperref[uc:08]{Teilaufgabe bearbeiten} \\
    UC-09 & \hyperref[uc:09]{Teilaufgabe löschen} \\
    UC-10 & \hyperref[uc:10]{Variante anlegen} \\
    UC-11 & \hyperref[uc:11]{Variante bearbeiten} \\
    UC-12 & \hyperref[uc:12]{Variante löschen} \\
    UC-13 & \hyperref[uc:13]{Klausurkonfiguration öffnen} \\
    UC-14 & \hyperref[uc:14]{Klausur generieren (PDF)} \\
    UC-15 & \hyperref[uc:15]{Musterlösung generieren (PDF)} \\
    UC-16 & \hyperref[uc:16]{Probeklausur generieren} \\
    UC-17 & \hyperref[uc:17]{PDF-Vorschau anzeigen} \\
    UC-18 & \hyperref[uc:18]{Sprache ändern} \\
\end{tabular}

\subsection{Anwenderfälle im Detail}

% -------------------------------
% UC-01
\usecase
{UC-01: XML-Datei neu anlegen}
{uc:01}
{Der Nutzer erstellt einen neuen, leeren Aufgabenpool (Exam).}
{Keine XML-Datei muss geladen sein.}
{
    \item Nutzer klickt auf "New Exam".
    \item genExam erzeugt eine interne Standardstruktur.
}
{Eine neue, leere Exam-Struktur ist im Speicher.}
\textbf{Fehlerbetrachtung:} Nicht relevant (Operation kann nicht fehlschlagen).

\columnbreak
% -------------------------------
% UC-02
\usecase
{UC-02: XML-Datei laden}
{uc:02}
{Eine bestehende XML-Datei (Exam) wird geladen.}
{Datei muss existieren und korrektes Format besitzen.}
{
    \item Nutzer wählt mittels Dateidialog eine XML-Datei.
    \item System lädt und validiert die Struktur.
}
{Der Aufgabenpool ist vollständig sichtbar.}
\textbf{Fehlerbetrachtung:}
\fehler{
    \item Datei korrupt → Fehlermeldung, Abbruch.
    \item Datei hat falsche Struktur → Fehlermeldung, Abbruch.
}

% -------------------------------
% UC-03
\usecase
{UC-03: XML-Datei speichern / Speichern unter}
{uc:03}
{Der aktuelle Aufgabenpool (Exam) wird gespeichert.}
{Ein gültiger Aufgabenpool wurde geladen oder erstellt.}
{
    \item Nutzer wählt "Save" oder "Save as".
    \item System schreibt XML-Datei.
}
{Alle Daten sind persistent gespeichert.}
\textbf{Fehlerbetrachtung:}
\fehler{
    \item Schreibfehler (z.B. fehlende Rechte) → Meldung.
}

\columnbreak
% -------------------------------
% UC-04
\usecase
{UC-04: Kapitel anlegen}
{uc:04}
{Ein neues Kapitel (Chapter / Task) wird zum Aufgabenpool hinzugefügt.}
{Ein Aufgabenpool ist geladen oder neu erstellt.}
{
    \item Nutzer klickt auf "Add Chapter".
    \item Kapitel wird mit Standardname angelegt.
}
{Ein neues Kapitel existiert im XML-Modell.}
\textbf{Fehlerbetrachtung:} Keine - trivialer Vorgang.

% -------------------------------
% UC-05
\usecase
{UC-05: Kapitel bearbeiten}
{uc:05}
{Kapitelname oder Metadaten eines Chapters / Tasks werden geändert.}
{Kapitel existiert.}
{
    \item Nutzer wählt Kapitel aus.
    \item Nutzer ändert Namen oder Kürzel.
}
{Kapitel wurde aktualisiert.}
\textbf{Fehlerbetrachtung:} Ungültiger Name → Hinweis, Änderung wird nicht übernommen.

% -------------------------------
% UC-06
\usecase
{UC-06: Kapitel löschen}
{uc:06}
{Ein Kapitel (Chapter / Task) inklusive aller Unterelemente wird gelöscht.}
{Kapitel existiert.}
{
    \item Nutzer klickt auf "Delete".
    \item Sicherheitsabfrage erscheint.
}
{Kapitel ist unwiderruflich entfernt.}
\textbf{Fehlerbetrachtung:} Keine - außer Nutzer bricht ab.

\columnbreak
% -------------------------------
% UC-07
\usecase
{UC-07: Teilaufgabe anlegen}
{uc:07}
{Innerhalb eines Kapitels wird ein Subtask erstellt.}
{Mindestens ein Kapitel existiert.}
{
    \item Nutzer wählt Kapitel.
    \item Nutzer klickt "Add Subtask".
}
{Neuer Subtask mit Standardvariant existiert.}
\textbf{Fehlerbetrachtung:} Keine.

% -------------------------------
% UC-08
\usecase
{UC-08: Teilaufgabe bearbeiten}
{uc:08}
{Ein Subtask wird editiert.}
{Subtask existiert.}
{
    \item Nutzer öffnet Subtask.
    \item Nutzer ändert Punktzahl, Schwierigkeitsgrad, Sichtbarkeit.
}
{Alle Änderungen sind übernommen.}
\textbf{Fehlerbetrachtung:}
\fehler{
    \item Punktzahl nicht im erlaubten Bereich.
    \item Schwierigkeitsgrad fehlt.
    \item Sichtbarkeit ungültig.
}

% -------------------------------
% UC-09
\usecase
{UC-09: Teilaufgabe löschen}
{uc:09}
{Ein Subtask wird gelöscht.}
{Subtask existiert.}
{}
{Subtask ist unwiderruflich gelöscht.}
\textbf{Fehlerbetrachtung:} Keine.

\columnbreak
% -------------------------------
% UC-10
\usecase
{UC-10: Variante anlegen}
{uc:10}
{Eine neue Variante wird einem Subtask hinzugefügt.}
{Subtask existiert.}
{
    \item Nutzer klickt "Add Variant".
}
{Variante existiert mit Standardwerten.}
\textbf{Fehlerbetrachtung:} Keine.

% -------------------------------
% UC-11
\usecase
{UC-11: Variante bearbeiten}
{uc:11}
{Frage- oder Antworttext einer Variante wird geändert.}
{Variante existiert.}
{
    \item Nutzer öffnet Variante.
    \item Nutzer bearbeitet Texte.
}
{Änderungen sind gespeichert.}
\textbf{Fehlerbetrachtung:}
\fehler{
    \item Leere Frage → Fehlermeldung.
}

% -------------------------------
% UC-12
\usecase
{UC-12: Variante löschen}
{uc:12}
{Eine Variante wird gelöscht.}
{Variante existiert.}
{}
{Variante gelöscht. Falls letzte Variante gelöscht → Subtask wird ebenfalls gelöscht.}
\textbf{Fehlerbetrachtung:} Keine.

\columnbreak
% -------------------------------
% UC-13
\usecase
{UC-13: Klausurkonfiguration öffnen}
{uc:13}
{Der Nutzer öffnet das Menü zur Generierung einer Klausur (Exam).}
{Mindestens ein Kapitel mit gültigen Subtasks existiert.}
{}
{Konfigurationsdialog sichtbar.}
\textbf{Fehlerbetrachtung:} Keine generierbaren Kapitel → Hinweis.

% -------------------------------
% UC-14
\usecase
{UC-14: Klausur generieren (PDF)}
{uc:14}
{System erstellt eine PDF-Klausur ohne Musterlösung aus dem Aufgabenpool (Exam).}
{\begin{itemize}
    \item Klausur ist gültig (Difficulty 33\%-Regel).
    \item Ausgabeort vom Nutzer gewählt.
\end{itemize}}
{}
{PDF-Datei existiert.}
\textbf{Fehlerbetrachtung:}
\fehler{
    \item Zielpunktzahl nicht möglich.
    \item Keine gültigen Aufgaben pro Kapitel.
}

% -------------------------------
% UC-15
\usecase
{UC-15: Musterlösung generieren}
{uc:15}
{Erzeugt eine PDF-Datei mit eingebetteten Musterlösungen der Subtasks/Variants.}
{Mindestens eine Variante hat eine Antwort.}
{}
{"exam.lsg.pdf" existiert.}
\textbf{Fehlerbetrachtung:}
\fehler{
    \item Keine Lösungen vorhanden → Warnung.
}

\columnbreak
% -------------------------------
% UC-16
\usecase
{UC-16: Probeklausur generieren}
{uc:16}
{Erzeugt eine rein aus Mock-Subtasks bestehende Klausur.}
{Mindestens ein Subtask ist als "mock-exam" markiert.}
{}
{Mock-Klausur-PDF existiert.}
\textbf{Fehlerbetrachtung:}
\fehler{
    \item Keine Mock-Aufgaben vorhanden → Fehlermeldung.
}

% -------------------------------
% UC-17
\usecase
{UC-17: PDF-Vorschau anzeigen}
{uc:17}
{Vor dem Export wird eine Vorschau der generierbaren Klausur (Exam) gerendert.}
{PDF muss generierbar sein.}
{}
{}
\textbf{Fehlerbetrachtung:}
\fehler{
    \item Fehlende PDF-Engine → Meldung.
}

\columnbreak
% -------------------------------
% UC-18
\usecase
{UC-18: Sprache ändern}
{uc:18}
{Die Benutzeroberfläche kann auf eine alternative Sprache umgestellt werden.}
{Alternative Sprache installiert.}
{}
{UI lädt neue Übersetzungen.}
\textbf{Fehlerbetrachtung:}
\fehler{
    \item Fehlende Übersetzung → Fallback zu Englisch.
}

\end{multicols}